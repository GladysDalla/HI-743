---
title: "Insurance Risk Prediction"
author: "Gladys Dalla"
date: "`r Sys.Date()`"
output: html_document
---

# 1. INTRODUCTION

Can we identify which members are likely to become high-cost before it happens — so we can intervene earlier and manage their care more effectively?

## 1.1. Problem Statement
In health insurance, a small group of people often accounts for most of the healthcare costs. These high-cost members usually have serious or multiple health conditions.

The challenge is: insurers often only find out after the member has already racked up high medical bills. By then, it’s too late to prevent those costs.

This leads to:

    Higher overall spending

    Missed opportunities to help patients earlier

    Poor use of care management resources
    
### 1.1.1. Business Goal

This project aims to help health insurers:

    Predict who is likely to become high-cost

    Group members into risk profiles based on age, insurance type, medical history, and care usage

By doing this, insurers can:

    Reach out to at-risk members before costs spike

    Offer better care plans or preventive services

    Use care management teams more effectively

    Price plans more accurately
    
### 1.1.2. Data Used    

We’re using real-world data from the Medical Expenditure Panel Survey (MEPS) — a large U.S. government health survey. Specifically:

    2022 Full Year Consolidated File (HC-243) — the most recent available file with full healthcare cost data (as of April 2025)
    
### 1.1.3. What the Project Does

The project uses two key steps:

    1. Segmentation (Clustering)
    Groups members into different types (e.g., “young + healthy” vs. “older + multi-chronic + uninsured”)

    2. Prediction (Logistic Regression)
    Builds a model to predict whether someone will end up in the top 25% of healthcare spenders.

## 1.2 Load Data

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(dplyr)
library(tidyr)
library(ggplot2)
library(readr)

# Automatically download and extract
url = "https://meps.ahrq.gov/mepsweb/data_files/pufs/h243/h243dat.zip"
download.file(url, temp <- tempfile())

# Extract path to .dat file
meps_path = unzip(temp, exdir = tempdir())
source("https://meps.ahrq.gov/mepsweb/data_stats/download_data/pufs/h243/h243ru.txt")

# Cleanup
unlink(temp)

meps_2022 = h243
```

# 2. 

```{r}
# View the data

head(meps_2022)
summary(meps$TOTEXP22)
```

## 3. 

```{r}
colnames(meps_2022)

```



```{r}
meps_clean <- meps_2022 %>%
  select(DUPERSID, AGE22X, SEX, RACEV2X, INSCOV22,
         OBTOTV22, ERTOT22, IPDIS22,
         HIBPDX, DIABDX_M18, CHDDX, STRKDX,
         TOTEXP22) %>%
  filter(!is.na(TOTEXP22)) %>% # keep only rows with expenditure values
  mutate(across(c(HIBPDX, DIABDX_M18, CHDDX, STRKDX), ~replace_na(., 0))) %>% # fill NAs with 0 for chronic flags
  mutate(
    SEX = factor(SEX, levels = c(1, 2), labels = c("Male", "Female")),  # recode 1 = Male, 2 = Female
    RACEV2X = factor(RACEV2X), # treat race as categorical
    INSCOV22 = factor(INSCOV22) # treat insurance coverage as categorical
  )
```


